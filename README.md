# zepto-with-sql
zepto end to end project with sql, following with technical questions and providing a clear insight for the client 
create table zepto(

sku_id SERIAL PRIMARY KEY,
CATEGORY VARCHAR(100),
name VARCHAR(100) NOT NULL,
mrp	NUMERIC(10,2),
discountPercent NUMERIC(10,2),	
availableQuantity INTEGER,	
discountedSellingPrice NUMERIC(10,2),
weightInGms	INTEGER,
outOfStock BOOLEAN,
quantity INTEGER
)

--DATA EXPLOARTION
SELECT * FROM ZEPTO;

--COUNT OF THE TABLE
SELECT COUNT(*)FROM ZEPTO;
``
--NULL VALUES
SELECT * FROM ZEPTO
WHERE NAME IS NULL

--UPDATING PAISE INTO RUPESS
UPDATE ZEPTO
SET MRP = MRP / 100.00,
DISCOUNTEDSELLINGPRICE = DISCOUNTEDSELLINGPRICE / 100.00 

SELECT MRP, DISCOUNTEDSELLINGPRICE FROM ZEPTO

--FINDING CATEGORIES
SELECT DISTINCT CATEGORY
FROM ZEPTO
ORDER BY CATEGORY

--PRODUCT IN STOCK VS OUTOFSTOCK
SELECT OUTOFSTOCK, COUNT(SKU_ID)
FROM ZEPTO
GROUP BY OUTOFSTOCK; 

--ANALYZING MRP AND DISCONT PERCENT 
SELECT MRP,DiscountPercent
FROM ZEPTO
ORDER BY MRP,DiscountPercent DESC

--SUMMATION OF TOTAL MRP AND DISCOUNTPERCENT
SELECT SUM(MRP) AS MRP ,SUM(DiscountPercent)  AS DiscountPercent
FROM ZEPTO;

--most sold category with available quatity,total products
SELECT Category,
    SUM(MRP) AS Total_MRP ,
    SUM(AVAILABLEQUANTITY) AS AVAILABLEQUANTITY,
    COUNT(*) AS Total_Products
FROM ZEPTO
GROUP BY Category 
ORDER BY Total_Products DESC;

-- COUNT OF PRODUCT NAME AND STOCK KEEPING UNITS
SELECT NAME, COUNT(SKU_ID) AS " NO OF SKU'S"
FROM ZEPTO
GROUP BY NAME
HAVING COUNT(SKU_ID)>1
ORDER BY COUNT(SKU_ID) DESC

--FINDING IF ANY PRODUCT AS PRICE OF 0
SELECT*FROM ZEPTO
WHERE MRP=0 OR DISCOUNTEDSELLINGPRICE= 0

--DELETING TABLES WITH PRICE 0
DELETE FROM ZEPTO
WHERE SKU_ID = 3607

SELECT DISTINCT NAME, WEIGHTINGMS
FROM ZEPTO
ORDER BY WEIGHTINGMS DESC;

select mrp,discountedsellingprice from zepto


--q1 list the top 10 products with most discountpercent 
select name,mrp,discountpercent
from zepto
order by discountpercent desc
limit 10

--Q2 GIVE THE PRODUCTS WITH HIGHT MRP BUT OUTOFSTOCK
SELECT DISTINCT NAME, MRP, OUTOFSTOCK
FROM ZEPTO
WHERE OUTOFSTOCK = TRUE AND MRP > 300
ORDER BY MRP DESC

--Q3 FIND THE ESTIMATED REVENUE OF EACH CATEGORY
SELECT DISTINCT CATEGORY,
SUM(DISCOUNTEDSELLINGPRICE * AVAILABLEQUANTITY) AS TOTAL_REVENUE
FROM ZEPTO
GROUP BY CATEGORY
ORDER BY TOTAL_REVENUE DESC;

--Q4 FIND ALL THE PRODUCTS WHERE MRP IS GREATER THAN 500 AND DISCOUNT IS LESS THEN 10%

SELECT DISTINCT NAME,MRP, DISCOUNTPERCENT
FROM ZEPTO
WHERE MRP > 500 AND DISCOUNTPERCENT <10
ORDER BY MRP DESC, DISCOUNTPERCENT DESC

--Q5 IDENTIFY THE TOP 5 CATEGORY OFFERING THE HIGHEST AVERAGE DISCOUNT PERCENT

SELECT CATEGORY, ROUND(AVG(DISCOUNTPERCENT),2) AS AVG_DISCOUNT
FROM ZEPTO
GROUP BY CATEGORY
ORDER BY AVG_DISCOUNT DESC
LIMIT 5

--Q6 FIND THE PRICE PER GRAM FOR PRODUCT ABOVE 100G AND SORT BY BEST VALUE
SELECT NAME,MRP,WEIGHTINGMS
FROM ZEPTO
WHERE WEIGHTINGMS >1000
ORDER BY name,MRP,WEIGHTINGMS DESC
LIMIT 10

--Q7 GROUP THE PRODUCTS INTO  CATEGORY LIKE LOW,MEDIUM,BULK

SELECT DISTINCT NAME,WEIGHTINGMS,
CASE WHEN WEIGHTINGMS < 1000 THEN 'LOW'
WHEN WEIGHTINGMS <5000 THEN'MEDIUM'
ELSE 'BULK'
END AS WEIGHT_IN_CATEGORY
FROM ZEPTO

SELECT NAME,WEIGHTINGMS,AVAILABLEQUANTITY
FROM ZEPTO
WHERE WEIGHTINGMS > 5000

--Q8 WHAT IS TOTAL INVENTORY WEIGHT PER CAETGORY
SELECT CATEGORY,
SUM(WEIGHTINGMS*AVAILABLEQUANTITY) AS TOTAL_INVENTORY_WEIGHT
FROM ZEPTO
GROUP BY CATEGORY
ORDER BY TOTAL_INVENTORY_WEIGHT DESC;


































